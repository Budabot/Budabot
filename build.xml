<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE project>
<project name="Budabot" default="build" basedir=".">
	<!-- include custom task for reading budabot's version from main.php file -->
	<taskdef classname="lib.PhingTasks.BudabotVersionTask" name="budabotversion" />

    <!-- ============================================  -->
    <!-- (DEFAULT) Target: build                        --> 
    <!-- ============================================  -->
	<target name="build">
		<echo>Create release package of Budabot.</echo>
		<svnlastrevision workingcopy="."       propertyname="svn.revision" />
		<budabotversion  sourcefile="main.php" propertyname="budabot.version" />
		<property name="build.basename" value="Budabot${budabot.version}_build${svn.revision}" />

		<delete dir="build" quiet="true" />
		<copy todir="build/contents/${build.basename}">
			<fileset dir=".">
				<include name="conf/log4php.xml" />
				<include name="conf/config.template.php" />
				<include name="core/**" />
				<include name="data/text.mdb" />
				<include name="docs/*.txt" />
				<include name="lib/**" />
				<exclude name="lib/composer.*" />
				<exclude name="lib/*.patch" />
				<exclude name="lib/PhingTasks**" />
				<include name="win32/**" />
				<include name="*.*" />
				<exclude name="build.xml" />
				<include name="modules/**" />
				<!-- define here modules which you wish to leave out of the archive -->
				<exclude name="modules/CIA_MODULE**" />
				<exclude name="modules/SVN_MODULE**" />
				<exclude name="modules/TEST_MODULE**" />
				<exclude name="modules/WORLDNET_MODULE**" />
			</fileset>
		</copy>
		<zip basedir="build/contents" destfile="build/${build.basename}.zip" />
	</target>

    <!-- ============================================  -->
    <!-- Target: Wikidoc                               -->
    <!-- ============================================  -->
	<target name="wikidoc">
		<echo>Generate Google Wiki documentation with ApiGen.</echo>
		<!-- destination can be overridden at command line -->
		<property name="wikidoc.destination" value="docs/wiki" />
		<apigen config="docs/apigen_wiki.neon" destination="${wikidoc.destination}" />
	</target>

    <!-- ============================================  -->
    <!-- Target: Apidoc                               -->
    <!-- ============================================  -->
	<target name="apidoc">
		<echo>Generate API documentation with ApiGen.</echo>
		<!-- destination can be overridden at command line -->
		<property name="apidoc.destination" value="docs/api" />
		<apigen source="core,modules" destination="${apidoc.destination}" title="Budabot" />
	</target>

</project>
